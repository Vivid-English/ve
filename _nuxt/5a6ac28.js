(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{192:function(t,e,r){"use strict";r.r(e),r.d(e,"getStarList",(function(){return f})),r.d(e,"hasStar",(function(){return h})),r.d(e,"addStar",(function(){return v}));r(202);var n=r(36),o=(r(16),r(12),r(20),r(92),r(53)),map=new Map;o.scenexx.forEach((function(t){map.set(t.post_id,t)}));var l,c=(l=localStorage.getItem("StarList"))?JSON.parse(l):[],d=function t(e){Object(n.a)(this,t),this.post_id=e,this.created_at=(new Date).toLocaleDateString()};function f(){return c.map((function(t){return map.get(t.post_id)}))}function h(t){return c.findIndex((function(e){return e.post_id===t.post_id}))>-1}function v(t){var e=c.findIndex((function(e){return e.post_id===t.post_id}));if(-1===e){var r=new d(t.post_id);c.splice(0,0,r)}else c.splice(e,1);localStorage.setItem("StarList",JSON.stringify(c))}},193:function(t,e,r){var content=r(199);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(67).default)("213156ce",content,!0,{sourceMap:!1})},196:function(t,e,r){"use strict";r(197)("big",(function(t){return function(){return t(this,"big","","")}}))},197:function(t,e,r){var n=r(6),o=r(13),l=r(25),c=/"/g,d=function(t,e,r,n){var o=String(l(t)),d="<"+e;return""!==r&&(d+=" "+r+'="'+String(n).replace(c,"&quot;")+'"'),d+">"+o+"</"+e+">"};t.exports=function(t,e){var r={};r[t]=e(d),n(n.P+n.F*o((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",r)}},198:function(t,e,r){"use strict";r(193)},199:function(t,e,r){(e=r(66)(!1)).push([t.i,".table caption{caption-side:top}.scene caption img{max-width:100%;display:block;margin:auto}a.play{padding:0 11px}.color0{color:#7f7f7f}.color1{color:#00f}.color2{color:#0f0}.color3{color:red}.color4{color:#0ff}.color5{color:#f0f}.color6{color:#ff7f00}.color7{color:#7f00ff}.color8{color:#007fff}.color9{color:#ff0}",""]),t.exports=e},200:function(t,e,r){"use strict";r(196);var n=r(194),o=(r(201),r(26),r(16),r(12),r(20),r(92),{name:"LineList",props:{list:{type:Array,required:!0},rolexx:{type:Array,required:!0},all:{type:Boolean,required:!0}},created:function(){this.setColor(),this.setName()},methods:{setColor:function(){var t=[],e=new Map;if(this.list.forEach((function(line){e.get(line.role_id)||(t.push(line.role_id),e.set(line.role_id,"color0"))})),t.length>1)for(var r=0;r<t.length;r++){var n=r+1;n>9&&(n=9),e.set(t[r],"color".concat(n))}this.list.forEach((function(line){line.color=e.get(line.role_id)}))},setName:function(){var t=this,map=new Map;map.set(1,""),this.list.forEach((function(line){if(map.has(line.role_id))line.name=map.get(line.role_id);else{line.name="";var e=t.rolexx.find((function(t){return t.id===line.role_id}));e&&(line.name=e.name,map.set(e.id,e.name))}}))}}}),l=r(7),c=Object(l.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tbody",t._l(t.list,(function(line){return r("tr",{directives:[{name:"show",rawName:"v-show",value:line.visible||t.all,expression:"line.visible || all"}],key:line.id},[r("td",{staticClass:"text-right",class:line.color},[t._v(t._s(line.name))]),t._v(" "),r("td",[t._v(t._s(line.text))])])})),0)}),[],!1,null,null,null).exports,d=r(204),f=r(205),h=r(203),v={name:"Scene",components:{Icon:n.a,LineList:c,PostList:d.a,PostRoot:f.a},props:{scene:{type:Object,required:!0},rolexx:{type:Array,required:!0},mixed:{type:Boolean,required:!1,default:!1}},data:function(){return{all:!1,star:!1,big:!1,hasHidden:!1,root:null}},created:function(){this.root=Object(h.a)(this.scene);var data=r(133);this.big=data.browser.window.innerWidth>800,this.hasHidden=!1===this.scene.linexx.every((function(line){return line.visible})),this.checkStar()},methods:{addStar:function(){r(192).addStar(this.scene),this.checkStar()},checkStar:function(){var data=r(192);this.star=data.hasStar(this.scene)}}},_=(r(198),Object(l.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("article",{staticClass:"col-sm-12"},[r("table",{staticClass:"table table-borderless scene",attrs:{id:"scene"+t.scene.id}},[r("caption",[r("img",{attrs:{src:t.scene.image,alt:t.scene.title}})]),t._v(" "),r("thead",[r("tr",[r("td",{staticClass:"text-right",attrs:{width:"25%"}},[r("span",{on:{click:t.addStar}},[r("Icon",{attrs:{icon:"star",color:"text-warning",active:t.star,size:1.5}})],1)]),t._v(" "),r("td",[t.mixed?r("nuxt-link",{staticClass:"mr11",attrs:{to:"/movie/"+t.scene.movie_id+"#scene"+t.scene.id}},[t._v("\n                        "+t._s(t.scene.time)+"\n                    ")]):r("span",{staticClass:"mr11"},[t._v(t._s(t.scene.time))]),t._v(" "),t.scene.video?r("a",{staticClass:"play",attrs:{href:t.scene.video,target:"_blank"}},[r("Icon",{attrs:{icon:"play",color:"text-primary",active:!0}})],1):t._e()],1)])]),t._v(" "),r("LineList",{attrs:{list:t.scene.linexx,rolexx:t.rolexx,all:t.all}}),t._v(" "),r("tfoot",[r("tr",[r("td",{staticClass:"text-right"},[t.hasHidden?r("span",{staticClass:"custom-control custom-switch"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.all,expression:"all"}],staticClass:"custom-control-input",attrs:{id:"linescene"+t.scene.id,type:"checkbox"},domProps:{checked:Array.isArray(t.all)?t._i(t.all,null)>-1:t.all},on:{change:function(e){var r=t.all,n=e.target,o=!!n.checked;if(Array.isArray(r)){var l=t._i(r,null);n.checked?l<0&&(t.all=r.concat([null])):l>-1&&(t.all=r.slice(0,l).concat(r.slice(l+1)))}else t.all=o}}}),t._v(" "),r("label",{staticClass:"custom-control-label",attrs:{for:"linescene"+t.scene.id}})]):t._e()]),t._v(" "),r("td",[r("PostRoot",{attrs:{item:t.scene,root:t.root}})],1)]),t._v(" "),t.root.visible?r("tr",[t.big?r("td"):t._e(),t._v(" "),r("td",{attrs:{colspan:t.big?1:2}},[r("PostList",{attrs:{list:t.root.list,loading:t.root.loading,root:t.root}})],1)]):t._e()])],1)])}),[],!1,null,null,null));e.a=_.exports},206:function(t,e,r){"use strict";var n={name:"ListLoader",props:{loader:{type:Object,required:!0}}},o=r(7),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t._t("head"),t._v(" "),t._l(t.loader.list,(function(e){return r("div",{key:e.id,staticClass:"row"},[r("hr",{staticClass:"col-sm-12"}),t._v(" "),t._t("body",null,{item:e})],2)})),t._v(" "),r("div",{staticClass:"mt11"},[t._t("foot"),t._v(" "),r("div",{staticClass:"text-center"},[r("button",{staticClass:"btn btn-outline-primary rounded-pill",attrs:{disabled:!t.loader.more},on:{click:function(e){return t.loader.load()}}},[t._v("\n                more\n            ")])])],2)],2)}),[],!1,null,null,null);e.a=component.exports},224:function(t,e,r){"use strict";r.r(e);var n=r(206),o=r(200),l=r(96),c=r(195),d={name:"ScenePage",components:{ListLoader:n.a,Scene:o.a},data:function(){return{title:"对话列表",loader:null,rolexx:[]}},created:function(){var t="ScenePageLoader";l.a.get(t)?this.loader=l.a.get(t):this.loader=l.a.make(t,Object(c.e)()),this.rolexx=Object(c.d)()},head:function(){return{title:this.title}}},f=r(7),component=Object(f.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ListLoader",{attrs:{loader:t.loader},scopedSlots:t._u([{key:"body",fn:function(e){return[r("Scene",{attrs:{scene:e.item,rolexx:t.rolexx,mixed:!0}})]}}])},[r("template",{slot:"head"},[r("h1",{staticClass:"m11"},[t._v(t._s(t.title))])])],2)}),[],!1,null,null,null);e.default=component.exports}}]);